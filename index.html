<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÛŒØ³Øª Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ</title>
    <style>
        body {
            font-family: 'Tahoma', sans-serif;
            background-color: #f4f6f8;
            padding: 20px;
            margin: 0;
            display: flex;
            justify-content: center;
        }
        .container {
            background: white;
            width: 100%;
            max-width: 500px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }
        h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        label {
            font-weight: bold;
            color: #555;
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
        }
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Tahoma';
            font-size: 15px;
            background-color: #fff;
            transition: 0.3s;
        }
        select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¬Ø¯ÙˆÙ„ Ù†ØªØ§ÛŒØ¬ */
        .result-table {
            width: 100%;
            margin-top: 25px;
            border-collapse: collapse;
            display: none; /* Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ Ù…Ø®ÙÛŒ */
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .result-table th {
            background-color: #34495e;
            color: white;
            padding: 10px;
            font-size: 13px;
        }
        .result-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            text-align: center;
            font-size: 14px;
            color: #333;
        }
        .result-table tr:last-child td {
            border-bottom: none;
        }
        .result-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .price-tag {
            color: #27ae60;
            font-weight: bold;
        }
        .empty-msg {
            text-align: center;
            color: #e74c3c;
            margin-top: 20px;
            display: none;
        }
        .footer {
            text-align: center;
            font-size: 11px;
            color: #aaa;
            margin-top: 30px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸš˜ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¯Ù‚ÛŒÙ‚ Ù‚ÛŒÙ…Øª</h2>
    
    <label>Û±. Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø±Ù†Ø¯ (Ú©Ø§Ø±Ø®Ø§Ù†Ù‡):</label>
    <select id="brandSelect" onchange="loadModels()">
        <option value="">Ù„Ø·ÙØ§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...</option>
    </select>
    
    <label>Û². Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¯Ù„ Ø®ÙˆØ¯Ø±Ùˆ:</label>
    <select id="modelSelect" onchange="showTable()" disabled>
        <option value="">Ø§Ø¨ØªØ¯Ø§ Ø¨Ø±Ù†Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
    </select>
    
    <div id="errorMsg" class="empty-msg">Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</div>

    <table id="priceTable" class="result-table">
        <thead>
            <tr>
                <th>ØªÛŒÙ¾ (Trim)</th>
                <th>Ø³Ø§Ù„</th>
                <th>Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>

    <div class="footer">Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ø±Ø¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯</div>
</div>

<script>
    let allCars = [];

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
    fetch('cars.json')
        .then(response => {
            if (!response.ok) throw new Error();
            return response.json();
        })
        .then(data => {
            allCars = data;
            populateBrands();
        })
        .catch(err => {
            document.getElementById("errorMsg").style.display = "block";
            document.getElementById("errorMsg").innerHTML = "âš ï¸ ÙØ§ÛŒÙ„ cars.json Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.<br>Ø§Ø¨ØªØ¯Ø§ Ø±Ø¨Ø§Øª Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯.";
        });

    // 1. Ù¾Ø± Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ø¨Ø±Ù†Ø¯Ù‡Ø§
    function populateBrands() {
        const brandSelect = document.getElementById("brandSelect");
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ø§Ù… Ø¨Ø±Ù†Ø¯Ù‡Ø§ Ùˆ Ø­Ø°Ù ØªÚ©Ø±Ø§Ø±ÛŒâ€ŒÙ‡Ø§
        const brands = [...new Set(allCars.map(car => car.brand))].sort();
        
        brands.forEach(brand => {
            let option = document.createElement("option");
            option.value = brand;
            option.text = brand;
            brandSelect.add(option);
        });
    }

    // 2. Ù¾Ø± Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù…Ø¯Ù„â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø±Ù†Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
    function loadModels() {
        const selectedBrand = document.getElementById("brandSelect").value;
        const modelSelect = document.getElementById("modelSelect");
        const table = document.getElementById("priceTable");
        
        // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù†
        modelSelect.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¯Ù„...</option>';
        table.style.display = "none";
        
        if (selectedBrand) {
            modelSelect.disabled = false;
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø§ÛŒÙ† Ø¨Ø±Ù†Ø¯
            const brandCars = allCars.filter(car => car.brand === selectedBrand);
            const models = [...new Set(brandCars.map(car => car.model))].sort();

            models.forEach(model => {
                let option = document.createElement("option");
                option.value = model;
                option.text = model;
                modelSelect.add(option);
            });
        } else {
            modelSelect.disabled = true;
        }
    }

    // 3. Ù†Ù…Ø§ÛŒØ´ Ø¬Ø¯ÙˆÙ„ Ù†Ù‡Ø§ÛŒÛŒ
    function showTable() {
        const selectedBrand = document.getElementById("brandSelect").value;
        const selectedModel = document.getElementById("modelSelect").value;
        const table = document.getElementById("priceTable");
        const tbody = document.getElementById("tableBody");
        
        tbody.innerHTML = ""; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¬Ø¯ÙˆÙ„ Ù‚Ø¨Ù„ÛŒ

        if (selectedModel) {
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ù…Ø§Ø´ÛŒÙ†â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø±Ù†Ø¯ Ùˆ Ù…Ø¯Ù„Ø´Ø§Ù† ÛŒÚ©ÛŒ Ø§Ø³Øª
            // (Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªØ±ÛŒÙ…â€ŒÙ‡Ø§ ÛŒØ§ Ø³Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯)
            const results = allCars.filter(car => 
                car.brand === selectedBrand && car.model === selectedModel
            );

            // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø§Ù„ (Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ø¨Ø§Ù„Ø§)
            results.sort((a, b) => b.year.localeCompare(a.year));

            results.forEach(car => {
                let row = `<tr>
                    <td>${car.trim}</td>
                    <td>${car.year}</td>
                    <td class="price-tag">${car.price}</td>
                </tr>`;
                tbody.innerHTML += row;
            });

            table.style.display = "table"; // Ù†Ù…Ø§ÛŒØ´ Ø¬Ø¯ÙˆÙ„
        } else {
            table.style.display = "none";
        }
    }
</script>

</body>
</html>